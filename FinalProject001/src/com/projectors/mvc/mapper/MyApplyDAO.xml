<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.projectors.mvc.IMyApplyDAO">

	<!-- 샘플 <select resultType="com.projectors.mvc.RecruitDTO" id="countRecruitMember"> 
		SELECT SUM(COUNTALL) AS COUNTALL , SUM(COUNTPOS) AS COUNTPOS , RECRUITNO 
		FROM RECRUITPOSITIONVIEW WHERE RECRUITNO LIKE '%' || #{recruitNo } GROUP 
		BY RECRUITNO </select> -->
	
	<select id="checkPresentApply" resultType="java.lang.Integer">
		SELECT  COUNT(*) AS COUNT
		FROM APPLY AP
		LEFT JOIN RECRUIT_POS REP ON AP.RECRUIT_POS_NO = REP.RECRUIT_POS_NO
		LEFT JOIN RECRUIT REC ON REP.RECRUIT_NO = REC.RECRUIT_NO
		WHERE AP.PIN_NO=#{pinNo} AND REC.CREATED_DATE > SYSDATE-14
	</select>
	
	<select id="getPresentApply" resultType="com.projectors.mvc.MyApplyDTO">
		SELECT AP.APPLY_NO AS APPLYNO, REP.RECRUIT_POS_NO AS RECRUITPOSNO, POS.POS_NAME AS POSNAME, REC.RECRUIT_NO AS RECRUITNO, REC.TITLE AS TITLE
      	 ,NVL(US.NICKNAME,'탈퇴회원') AS NICKNAME , AP.APPLY_DATE AS APPLYDATE, AP.CK_DATE AS CKDATE
		FROM APPLY AP
		LEFT JOIN RECRUIT_POS REP ON AP.RECRUIT_POS_NO = REP.RECRUIT_POS_NO
		LEFT JOIN RECRUIT REC ON REP.RECRUIT_NO = REC.RECRUIT_NO
		LEFT JOIN POSITION POS ON REP.POS_NO = POS.POS_NO
		LEFT JOIN USERS US ON AP.PIN_NO = US.PIN_NO
		WHERE AP.PIN_NO=#{pinNo} AND REC.CREATED_DATE > SYSDATE-14
	</select>
	
</mapper>